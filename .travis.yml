language: php

php:
  - 5.4

env:
    - WP_VERSION=master WP_MULTISITE=0

before_install:
  - sudo apt-get update > /dev/null
  - composer self-update

install:
  - sudo apt-get install -y --force-yes php5-cgi php5-mysql
#  - sudo apt-get install -y --force-yes apache2 libapache2-mod-php5 php5-curl php5-mysql php5-intl

before_script:
  - echo 'date.timezone = "Europe/London"' >> ~/.phpenv/versions/$(phpenv version-name)/etc/conf.d/travis.ini

script:
  # Create display.
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - sleep 3 # give xvfb some time to start

  - composer update --no-interaction --prefer-dist
  - sudo /etc/init.d/apache2 restart
  - pwd
  - ls -alh ..
  - ls -alh bin
  - ls -alh vendor
  - ./bin/wp core download
  - ls -alh



  # Run selenium.
#  - wget http://selenium-release.storage.googleapis.com/2.45/selenium-server-standalone-2.45.0.jar
#  - java -jar selenium-server-standalone-2.45.0.jar -p 4444 > ~/selenium.log 2>&1 &
#  - sleep 5

  # Run phantomJs.
#  - phantomjs --webdriver=4444 > ~/phantomjs.log 2>&1 &

  # Run behat tests.
#  - ls -alh
#  - ls -alh ..
#  - cd ../behat
#  - ./bin/behat --tags=~@wip

  # Print log ~/phantomjs.log
#  - cat ~/phantomjs.log

  # Print log ~/selenium.log
#  - cat ~/selenium.log
